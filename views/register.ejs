<!DOCTYPE html>
<html lang="en">

<%- include('./partials/head.ejs', {pageTitle: 'Registro' }); %>

  <body>

    <%- include('./partials/header.ejs') %>

      <main class="mainregister">

        <div id="errors">
        </div>

        <form id="formularioRegister" action="/users/register" method="POST" class="formregister"
          enctype="multipart/form-data">

          <div class="containerRegister">
            <label class="pure-material-textfield-outlined">
              <input type="text" id="full_name" name="full_name"
                value="<%= locals.oldData ? oldData.full_name : null %>" placeholder=" ">
              <span>Nombre y Apellido</span>
            </label>
            <br>
            <div class="errors">
              <% if(locals.errors && errors.full_name) { %>
                <%= errors.full_name.msg %>
                  <% } %>
            </div>
            <br>
            <div id="nameError" class="errors-front">
            </div>
          </div>

          <div class="containerRegister">
            <label class="pure-material-textfield-outlined">
              <input type="email" id="email" name="email" value="<%= locals.oldData ? oldData.email : null %>"
                placeholder=" ">
              <span>E-mail</span>
            </label>
            <br>
            <div class="errors">
              <% if(locals.errors && errors.email) { %>
                <%= errors.email.msg %>
                  <% } %>
            </div>
            <br>
            <div id="emailError" class="errors-front">
            </div>
          </div>

          <div class="containerRegister">
            <label class="pure-material-textfield-outlined">
              <input type="password" id="password" name="password"
                value="<%= locals.oldData ? oldData.password : null %>" placeholder=" ">
              <span>Contraseña</span>
            </label>
            <br>
            <div class="errors">
              <% if(locals.errors && errors.password) { %>
                <%= errors.password.msg %>
                  <% } %>
            </div>
            <br>
            <div id="passwordError" class="errors-front">
            </div>
          </div>

          <div class="containerRegister">
            <label class="pure-material-textfield-outlined">
              <input type="number" name="phone" value="<%= locals.oldData ? oldData.phone : null %>" placeholder=" ">
              <span>Celular</span>
            </label>
            <br>
            <div class="errors">
              <% if(locals.errors && errors.phone) { %>
                <%= errors.phone.msg %>
                  <% } %>
            </div>
          </div>

          <!-- Qué hacer con los address y los user_type (el address debería poder ponerlo el usuario,
y dependiendo del edificio que elijan se guarde el address_id correspondiente en la base de datos
En cuanto al user_type_id debería ponerse automáticamente ya que todos son clientes, menos los administradores
No se como manejar ésta situación -->

          <div class="containerRegister">
            <label>Direccion de Entrega:</label>
            <select name="adress_id" id="adress_id">
              <% for (let i=0; i < adress.length; i++) { %>
                <option value="<%= adress[i].dataValues.id %>">
                  <%= adress[i].dataValues.street %>
                </option>
                <% } %>
            </select>
            <div class="errors">
              <% if(locals.errors && errors.adress_id) { %>
                <%= errors.adress_id.msg %>
                  <% } %>
            </div>
          </div>

          <!-----hasta aquí   ----------------------------------->

          <div class="containerRegister">
            <label class="pure-material-textfield-outlined">
              <input type="file" id="avatar" placeholder=" " name="avatar"
                value="<%= locals.oldData ? oldData.image : null %>">
              <span>Imagen</span>
            </label>
            <br>
            <div class="errors">
              <% if(locals.errors && errors.avatar) { %>
                <%= errors.avatar.msg %>
                  <% } %>
            </div>
          </div>

          <div class="registerButton">
            <button type='submit' class="pure-material-button-contained">Registrarse</button>
            <button type='reset' class="pure-material-button-contained">Borrar</button>
          </div>

        </form>

      </main>

      <%- include('./partials/footer.ejs') %>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
          crossorigin="anonymous"></script>
        <script src="/js/ValidareRegisterFrontend.js"></script>
        <script src="/js/carro.js"></script>
  </body>

</html>